


<div class="container"> <br />
    <div class="row">
      <div class="col-md-7">
      <div class="panel panel-default">
        <div class="panel-heading"><strong>Upload files</strong> <small> </small></div>
        <div class="panel-body">

          <div class="input-group image-preview">

            <input placeholder="" type="text" class="form-control image-preview-filename" disabled="disabled">
            <!-- don't give a name === doesn't send on POST/GET -->
            <span class="input-group-btn">
            <!-- image-preview-clear button -->
            <button type="button" class="btn btn-default image-preview-clear" style="display:none;"> <span class="glyphicon glyphicon-remove"></span> Clear </button>
            <!-- image-preview-input -->
            <div class="btn btn-default image-preview-input"> <span class="glyphicon glyphicon-folder-open"></span> <span class="image-preview-input-title">Browse</span>
              <input type="file" accept="image/png, image/jpeg, image/gif" name="input-file-preview"/>
              <!-- rename it -->
            </div>
            <button type="button" class="btn btn-labeled btn-default"> <span class="btn-label"><i class="glyphicon glyphicon-upload"></i> </span>Upload</button>
            </span>

          </div>
          <!-- /input-group image-preview [TO HERE]-->

          <br />



        </div>
      </div>
    </div>
  </div>
</div>




  <script>
  var recordings = [];
  var markerarray = []
function RecordingLoc(latitude, longitude) {
  this.latitude = latitude;
  this.longitude = longitude;
}



function initialize() {

  var mapProp = {
    zoom:15,
    mapTypeId:google.maps.MapTypeId.ROADMAP
  };
  var map=new google.maps.Map(document.getElementById("route2"),mapProp);
  var input = document.getElementById('pac-input');
  var searchBox = new google.maps.places.SearchBox(input);
  map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

google.maps.event.addListener(map, 'click', function(e) {
  if (markerarray.length >0){
    for (i=0; i< markerarray.length; i++){
      markerarray[i].setMap(null)
    }
    markerarray = []
  }
        placeMarker(e.latLng, map);



      });


      function placeMarker(position, map) {
        var marker = new google.maps.Marker({
          position: position,
          map: map
        });
          markerarray.push(marker)


        map.panTo(position);
        var latitude = marker.position.lat();
        var longitude = marker.position.lng();
              if(recordings.length > 0) {
             recordings = []
            $(".reclocation").remove()


        }
         var location = new RecordingLoc(latitude, longitude);
        recordings.push(location);
           $(".new_recording").prepend("<input type='hidden' class='reclocation' name='recording[latitude]' value="+location.latitude+" id= 'amihere' >");
           $(".new_recording").prepend("<input type='hidden' class='reclocation' name='recording[longitude]' value="+location.longitude+" >");



      }

  searchBox.addListener('places_changed', function() {
    var places = searchBox.getPlaces();

    if (markerarray.length == 0) {
      markerarray.push(placeMarker(places[0].geometry.location, map))
    }

    else if (markerarray.length > 0) {
      markerarray[0].setMap(null)
      markerarray= []
    var anothermarker = placeMarker(places[0].geometry.location, map)
    markerarray.push(anothermarker)


  }

})

 if(navigator.geolocation) {
    browserSupportFlag = true;
    navigator.geolocation.getCurrentPosition(function(position) {
      initialLocation = new google.maps.LatLng(position.coords.latitude,position.coords.longitude);
      map.setCenter(initialLocation);
    }, function() {
      handleNoGeolocation(browserSupportFlag);
    });
  }
  // Browser doesn't support Geolocation
  else {
    browserSupportFlag = false;
    handleNoGeolocation(browserSupportFlag);
  }

  function handleNoGeolocation(errorFlag) {
    if (errorFlag == true) {
      map.setCenter(new google.maps.LatLng(0,0))
      map.setZoom(0)

    }

    map.setCenter(initialLocation);
  }

}
google.maps.event.addDomListener(window, 'load', initialize);



</script>

